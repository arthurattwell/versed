function versedReady(){return navigator.userAgent.indexOf("Opera Mini")===-1&&"querySelectorAll"in document&&"innerHTML"in document&&"replaceChild"in document&&"startsWith"in document&&document.querySelectorAll(".versed")}function versedWrapVerse(verse){var wrapper=document.createElement("div");wrapper.setAttribute("class","versed-wrapper");wrapper.innerHTML=verse.outerHTML;verse.parentNode.replaceChild(wrapper,verse)}function versedStripSpaces(str){var newStr=str.replace(/(^ +| +$)/g,"");return newStr}function versedWrapLines(stanza,match){stanza.innerHTML=stanza.innerHTML.replace(match||/.+(?=<br[ \/]*>|[\s]*$)/gim,function(line){return'<span class="versed-line-'+(stanza=-~stanza)+'">'+versedStripSpaces(line)+"</span>"}).replace(/<br[ \/]*>/gim,"")}function versedCountIndents(line,spaces){var indentingSpaces=line.innerHTML.split(/[^\s\u2003]/,1);return(indentingSpaces[0].match(spaces)||[]).length}function versedIndentLines(verse){var lines=verse.querySelectorAll('[class*="versed-line-"]');for(var i=0;i<lines.length;i++){var line=lines[i];var spaces=/\u2003/gi;var indents=versedCountIndents(line,spaces);if(indents>0){line.setAttribute("class","versed-line-indent-"+indents)}}}function versed(){var versed=document.querySelectorAll(".versed");for(var i=0;i<versed.length;i++){var verse=versed[i];var stanzas=verse.querySelectorAll("p");for(var j=0;j<stanzas.length;j++){var stanza=stanzas[j];versedWrapLines(stanza);versedIndentLines(verse)}versedWrapVerse(verse)}}window.onload=function(){if(versedReady){versed()}else{console.log("Sorry, the browser doesn't support what we need for versed.js");return}};